<?xml version="1.0"?>

<PropertyList>

  <enable type="bool">true</enable>

  <!-- global tasks: each of these are run every iteration -->
  <global_tasks>
    <task>
      <name>home_manager</name>
    </task>

    <task>
      <name>lost_link</name>
      <timeout_sec>60</timeout_sec>
      <action_nickname>circle_home</action_nickname>
    </task>

    <task>
      <name>throttle_safety</name>
      <safety_on_ground type="bool">true</safety_on_ground>
    </task>

    <task>
      <name>is_airborne</name>
      <!-- "off" in the sense of "off" the ground if we exceed these values -->
      <off_alt_agl_ft>10</off_alt_agl_ft>
      <off_airspeed_kt>15</off_airspeed_kt>
      <!-- "on" the ground if we drop below these values-->
      <on_alt_agl_ft>30</on_alt_agl_ft>
      <on_airspeed_kt>10</on_airspeed_kt>
    </task>

    <task>
      <name>camera_trigger</name>
      <vert_fov_deg>29.3273</vert_fov_deg>
      <overlap_pct>0.10</overlap_pct>
      <min_agl_ft>200.0</min_agl_ft>
      <min_rate_sec>3.0</min_rate_sec>
      <max_rate_sec>60.0</max_rate_sec>
      <!-- <trigger-gpio>146</trigger-gpio> -->
      <trigger_prop>/controls/flight/rudder</trigger_prop>
    </task>

  </global_tasks>

  <!-- sequential tasks: only the front item in the fifo queue is run -->
  <sequential_tasks>
    <task>
      <name>launch</name>
      <speed_kt>30</speed_kt>
      <completion_alt_ft>200</completion_alt_ft>
      <roll_gain>0.3</roll_gain>
      <roll_limit>5.0</roll_limit>
      <rudder_enable type="bool">false</rudder_enable>
    </task>

    <task>
      <name>route</name>
      <altitude_agl_ft>500</altitude_agl_ft>
      <speed_kt>35</speed_kt>
    </task>
  </sequential_tasks>

  <!-- standby tasks: a list of tasks that are initialized and configured -->
  <!-- and could be moved to the global or sequential task lists at any -->
  <!-- time. -->
  <standby_tasks>
    <task>
      <name>circle</name>
      <nickname>circle_home</nickname>
      <config>/mission/home</config>
      <radius_m>100</radius_m>
      <altitude_agl_ft>500</altitude_agl_ft>
      <speed_kt>35</speed_kt>
    </task>

    <task>
      <name>circle</name>
      <nickname>circle_target</nickname>
      <config>/mission/circle</config>
      <radius_m>100</radius_m>
    </task>

    <task>
      <name>circle</name>
      <nickname>circle_descent</nickname>
    </task>
    
    <task>
      <name>land</name>
      <lateral_offset_m>0.0</lateral_offset_m>
      <glideslope_deg>5.0</glideslope_deg>
      <turn_radius_m>100</turn_radius_m>
      <turn_steps>8</turn_steps>
      <direction>left</direction>
      <extend_final_leg_m>70</extend_final_leg_m>
      <alt_bias_ft>100</alt_bias_ft>
      <approach_speed_kt>35</approach_speed_kt>
      <flare_pitch_deg>3.5</flare_pitch_deg>
      <flare_seconds>5</flare_seconds>
    </task>
  </standby_tasks>

</PropertyList>
