<?xml version="1.0"?>

<PropertyList>

  <enable type="bool">true</enable>

  <!-- global tasks: each of these are run every iteration -->
  <global-tasks>
    <task>
      <name>home-manager</name>
    </task>

    <task>
      <name>lost-link</name>
      <timeout-sec>60</timeout-sec>
      <action-nickname>circle-home</action-nickname>
    </task>

    <task>
      <name>throttle-safety</name>
      <safety-on-ground>true</safety-on-ground>
    </task>

    <task>
      <name>is-airborne</name>
      <!-- "off" in the sense of "off" the ground if we exceed these values -->
      <off-alt-agl-ft>10</off-alt-agl-ft>
      <off-ground-speed-kt>10</off-ground-speed-kt>
      <off-air-speed-kt>15</off-air-speed-kt>
      <!-- "on" the ground if we drop below these values-->
      <on-ground-speed-kt>5</on-ground-speed-kt>
      <on-air-speed-kt>10</on-air-speed-kt>
    </task>

  </global-tasks>

  <!-- sequential tasks: only the front item in the fifo queue is run -->
  <sequential-tasks>
    <task>
      <name>launch</name>
      <speed-kt>20</speed-kt>
      <completion-alt-ft>150</completion-alt-ft>
      <roll-gain>0.5</roll-gain>
      <roll-limit>10.0</roll-limit>
      <rudder-enable>true</rudder-enable>
      <rudder-gain>-0.03</rudder-gain>
      <rudder-max>0.5</rudder-max>
    </task>

    <task>
      <name>route</name>
      <route include="../routes/bowtie-300m.xml" />
      <altitude-agl-ft>300</altitude-agl-ft>
      <speed-kt>20</speed-kt>
    </task>
  </sequential-tasks>

  <!-- standby tasks: a list of tasks that are initialized and configured -->
  <!-- and could be moved to the global or sequential task lists at any -->
  <!-- time. -->
  <standby-tasks>
    <task>
      <name>recalibrate</name>
    </task>

    <task>
      <name>preflight</name>
      <timeout-sec>60.0</timeout-sec>
    </task>

    <task>
      <name>circle-coord</name>
      <nickname>circle-home</nickname>
      <coord-path>/task/home</coord-path>
      <radius-m>75</radius-m>
      <altitude-agl-ft>250</altitude-agl-ft>
      <speed-kt>20</speed-kt>
    </task>

    <task>
      <name>circle-coord</name>
      <nickname>circle-target</nickname>
      <!-- <radius-m>100</radius-m> -->
      <!-- <altitude-agl-ft>400</altitude-agl-ft> -->
      <!-- <speed-kt>30</speed-kt> -->
    </task>
    
    <task>
      <name>land</name>
      <lateral-offset-m>0.0</lateral-offset-m>
      <glideslope-deg>7.0</glideslope-deg>
      <turn-radius-m>75</turn-radius-m>
      <turn-steps>8</turn-steps>
      <direction>left</direction>
      <extend-final-leg-m>100</extend-final-leg-m>
      <alt-bias-ft>0</alt-bias-ft>
      <approach-speed-kt>18</approach-speed-kt>
      <flare-pitch-deg>0</flare-pitch-deg>
      <flare-seconds>5</flare-seconds>
    </task>

    <task>
      <name>camera-trigger</name>
      <vert-fov-deg>29.3273</vert-fov-deg>
      <overlap-pct>0.25</overlap-pct>
      <min-agl-ft>200.0</min-agl-ft>
      <min-rate-sec>3.0</min-rate-sec>
      <max-rate-sec>60.0</max-rate-sec>
      <trigger-gpio>146</trigger-gpio>
    </task>

  </standby-tasks>

</PropertyList>
